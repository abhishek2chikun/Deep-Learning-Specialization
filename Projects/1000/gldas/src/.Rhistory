prod.dir
dir_raw = '/home/satyukt/Projects/1000/gldas/raw_data'
raw.dir = '/home/satyukt/Projects/1000/gldas/raw_data'
year = "2020"
day_of_year <- "291"
in.files <- Sys.glob(file.path(raw.dir,sprintf("/*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
file.path(raw.dir)
in.files <- Sys.glob(file.path(raw.dir),sprintf("/*/*/*/*/%s/%s/*.nc4", year,day_of_year))
in.files <- Sys.glob(file.path(raw.dir),sprintf("/*/*/*/*/%s/%s/*.nc4", year,day_of_year))
file.path(raw.dir,sprintf("/*/*/*/*/%s/%s/*.nc4", year,day_of_year))
raw.dir = '/home/satyukt/Projects/1000/gldas/raw_data'
file.path(raw.dir,sprintf("/*/*/*/*/%s/%s/*.nc4", year,day_of_year))
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year))
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
for (in.file  in in.files) {
parameters = c('SoilMoi0_10cm_inst', 'SoilMoi10_40cm_inst', 'SoilMoi40_100cm_inst','SoilMoi100_200cm_inst',
'SoilTMP0_10cm_inst','SoilTMP10_40cm_inst','SoilTMP40_100cm_inst','SoilTMP100_200cm_inst')
for (parameter in parameters) {
in.ras = raster(in.file,varname=parameter)
product = substr(parameter,1,7)
if(product =="SoilMoi"){
depth = gsub("SoilMoi","",parameter)
product = "sm"
}else if (product == "SoilTMP"){
depth = gsub("SoilTMP","",parameter)
product = "temp"
}
depth = gsub("_inst","",depth)
date = as.Date(day_of_year, format = "%j")
date = gsub("-","",date)
prod.dir = sprintf("%s/%s/%s",out.dir,product,depth)
dir.create(prod.dir,recursive = T)
out.file = sprintf("%s/%s.nc",prod.dir,date)
if(!file.exists(out.file)){
writeRaster(in.ras,out.file)
}
}
}
install.packages("raster")
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
# To convert the level2 rawdata ncdf file into the tiff file of quarter degree
# Loading required packages
library(ncdf4)
raw.dir
# Read input from shell
args = commandArgs(trailingOnly=TRUE)
raw.dir <- args[1]
out.dir <- args[2]
year = args[3]
day_of_year <- args[4]
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
raw.dir
dir_raw <- '/media/satyukt/vaari/Projects/1000/gldas/raw_data'
dir_nc <- '/media/satyukt/vaari/Projects/1000/gldas/nc'
year <- 2015
# To convert the level2 rawdata ncdf file into the tiff file of quarter degree
# Loading required packages
library(ncdf4)
# library(akima)
# require(AtmRay)
require(raster)
dir_raw <- '/media/satyukt/vaari/Projects/1000/gldas/raw_data'
dir_nc <- '/media/satyukt/vaari/Projects/1000/gldas/nc'
year <- 2015
day_of_year <- '001'
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year))
raw.dir <- '/media/satyukt/vaari/Projects/1000/gldas/raw_data'
out.dir <- '/media/satyukt/vaari/Projects/1000/gldas/nc'
year <- 2015
day_of_year <- '001'
in.files <- Sys.glob(file.path(raw.dir,sprintf("*/*/*/*/%s/%s/*.nc4", year,day_of_year)))
in.files
source('~/Projects/1000/gldas/src/convert_nc.R')
parameters = c('SoilMoi0_10cm_inst', 'SoilMoi10_40cm_inst', 'SoilMoi40_100cm_inst','SoilMoi100_200cm_inst',
'SoilTMP0_10cm_inst','SoilTMP10_40cm_inst','SoilTMP40_100cm_inst','SoilTMP100_200cm_inst')
parameters
source('~/Projects/1000/gldas/src/convert_nc.R')
parameter
in.ras = raster(in.file,varname=parameter)
in.ras
in.file
in.ras
in.ras = raster(in.file, varname = parameter)
product = substr(parameter, 1, 7)
product
depth = gsub("SoilMoi","",parameter)
product
depth = gsub("SoilMoi","",parameter)
product = "sm"
depth = gsub("_inst","",depth)
date = as.Date(day_of_year, format = "%j")
date = gsub("-","",date)
prod.dir = sprintf("%s/%s/%s",out.dir,product,depth)
prod.dir
dir.create(prod.dir,recursive = T)
out.file = sprintf("%s/%s.nc",prod.dir,date)
out.file
out.file
date
day_of_year
basename(in.file)
in.files
date
parameters = c('SoilMoi0_10cm_inst', 'SoilMoi10_40cm_inst', 'SoilMoi40_100cm_inst','SoilMoi100_200cm_inst',
'SoilTMP0_10cm_inst','SoilTMP10_40cm_inst','SoilTMP40_100cm_inst','SoilTMP100_200cm_inst')
parameters
in.ras = raster(in.file, varname = parameter)
in.ras
product = substr(parameter, 1, 7)
product
out.file = sprintf("%s/%s.nc",prod.dir,out.bn)
in.bn <- basename(in.file)
in.bn
out.bn <- gsub('nc4', 'tif', in.bn)
out.bn
out.file = sprintf("%s/%s.nc",prod.dir,out.bn)
out.file
in.bn
out.bn <- gsub('nc4', 'tif', in.bn)
out.bn
out.file = sprintf("%s/%s",prod.dir,out.bn)
out.file
out.file
out.file
plot(in.ras)
substr(in.bn, 10, 20)
substr(in.bn, 10, 30)
substr(in.bn, 10, 40)
substr(in.bn, 18, 40)
substr(in.bn, 19, 40)
nchar(in.bn)
substr(in.bn, 19, 39)
substr(in.bn, 19, 35)
yyyymmdd.hhmm.vvv <- substr(in.bn, 19, 35)
yyyymmdd.hhmm.vvv
yyyymmdd.hhmm.vvv <- gsub('.', '_', yyyymmdd.hhmm.vvv)
yyyymmdd.hhmm.vvv
yyyymmdd.hhmm.vvv <- substr(in.bn, 19, 35)
gsub('[.]', '_', yyyymmdd.hhmm.vvv)
yyyymmdd.hhmm.vvv
yyyymmdd.hhmm.vvv <- gsub('[.]', '_', yyyymmdd.hhmm.vvv)
yyyymmdd.hhmm.vvv
out.bn <- sprintf('%s.tif', yyyymmdd.hhmm.vvv)
out.bn
out.file = sprintf("%s/%s",prod.dir,out.bn)
out.file
out.file = file.path(prod.dir,out.bn)
out.file
source('~/Projects/1000/gldas/src/convert_nc.R')
out.file
source('~/Projects/1000/gldas/src/convert_nc.R')
source('~/Projects/1000/gldas/src/convert_nc.R')
